---
# Generate the backup script using the template module
- name: Generate backup script from template
  template:
    src: backup.sh.j2
    dest: "{{ scripts_path }}/cron/backup.sh"
    mode: '0755'
    owner: "{{ sudo_user }}"
    group: "{{ sudo_user }}"

# Create cron job for the backup script
- name: Create a cron job for the backup script
  ansible.builtin.cron:
    name: "Daily Backup Sync"
    user: "{{ sudo_user }}"
    minute: "0"
    hour: "2"  # Runs daily at 2 AM
    job: "{{ scripts_path }}/cron/backup.sh"
